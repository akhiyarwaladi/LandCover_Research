================================================================================
TRAINING ALL RESNET VARIANTS
================================================================================
Start: 2026-01-03 19:42:27
Device: cuda

--------------------------------------------------------------------------------
LOADING DATA
--------------------------------------------------------------------------------
‚úì KLHK: 27,995 polygons
‚úì Sentinel-2: (10, 11268, 18740)
‚úì Features: 23 bands

üßπ Cleaning NaN/Inf values...
   Found NaN: True, Inf: False
   ‚úì Replaced with 0
‚úì Labels: (11268, 18740)

Extracting patches...

üì¶ Extracting patches:
   Patch size: 32x32
   Stride: 16
   Input shape: (23, 11268, 18740)
   Total possible patches: 822,510
   Valid patches: 480,718
   Sampling 100,000 patches...

   ‚ö†Ô∏è  Remapping non-sequential labels for PyTorch:
     0 ‚Üí 0
     1 ‚Üí 1
     4 ‚Üí 2
     5 ‚Üí 3
     6 ‚Üí 4
     7 ‚Üí 5

   Final patches: 100,000
   Patch shape: (23, 32, 32)

   Class distribution (after remapping):
     Class 0: 1,113 (1.1%)
     Class 1: 37,082 (37.1%)
     Class 2: 57,349 (57.3%)
     Class 3: 175 (0.2%)
     Class 4: 2,782 (2.8%)
     Class 5: 1,499 (1.5%)
‚úì Patches: X=(100000, 23, 32, 32), y=(100000,)

Normalizing each channel independently...
   Channel  0: mean=  0.0229, std=  0.0220
   Channel  5: mean=  0.1912, std=  0.1572
   Channel 10: mean=  0.4788, std=  0.3941
   Channel 15: mean= -0.1568, std=  0.1649
   Channel 20: mean=  0.4261, std=  0.3461
‚úì Normalized
‚úì Train: 80,000, Test: 20,000

################################################################################
# 1/4: RESNET18
################################################################################

================================================================================
TRAINING RESNET18
================================================================================
[ 1/30] Loss: 0.7333/0.6512 Acc: 71.30%/74.44% ‚úì
[ 2/30] Loss: 0.6641/0.6479 Acc: 74.21%/74.80% ‚úì
[ 3/30] Loss: 0.6382/0.6172 Acc: 75.24%/75.85% ‚úì
[ 4/30] Loss: 0.6157/0.6007 Acc: 76.13%/76.83% ‚úì
[ 5/30] Loss: 0.5989/0.6012 Acc: 76.63%/76.89% ‚úì
[ 6/30] Loss: 0.5774/0.5814 Acc: 77.44%/77.06% ‚úì
[ 7/30] Loss: 0.5599/0.5937 Acc: 78.19%/77.14% ‚úì
[ 8/30] Loss: 0.5384/0.5912 Acc: 79.01%/77.09% 
[ 9/30] Loss: 0.5159/0.6270 Acc: 79.82%/75.83% 
[10/30] Loss: 0.4918/0.6232 Acc: 80.75%/76.50% 
[11/30] Loss: 0.4662/0.6929 Acc: 81.76%/73.80% 
[12/30] Loss: 0.4459/0.6444 Acc: 82.54%/76.58% 
[13/30] Loss: 0.4247/0.6843 Acc: 83.40%/75.97% 
[14/30] Loss: 0.4082/0.8081 Acc: 84.01%/73.69% 
[15/30] Loss: 0.3987/0.7057 Acc: 84.37%/75.67% 
[16/30] Loss: 0.3845/0.7381 Acc: 84.95%/75.11% 
[17/30] Loss: 0.3792/0.7399 Acc: 85.13%/75.41% 
[18/30] Loss: 0.3680/0.7792 Acc: 85.57%/75.31% 
[19/30] Loss: 0.3650/0.7976 Acc: 85.67%/74.67% 
[20/30] Loss: 0.3606/0.7768 Acc: 85.84%/75.23% 
[21/30] Loss: 0.3571/0.7845 Acc: 86.01%/75.83% 
[22/30] Loss: 0.3515/0.7603 Acc: 86.24%/75.53% 
[23/30] Loss: 0.3491/0.7923 Acc: 86.26%/75.19% 
[24/30] Loss: 0.3510/0.8121 Acc: 86.19%/75.46% 
[25/30] Loss: 0.3443/0.7726 Acc: 86.47%/75.50% 
[26/30] Loss: 0.3430/0.8635 Acc: 86.48%/75.01% 
[27/30] Loss: 0.3408/0.7882 Acc: 86.53%/75.74% 
[28/30] Loss: 0.3388/0.8182 Acc: 86.63%/76.41% 
[29/30] Loss: 0.3377/0.8219 Acc: 86.72%/75.65% 
[30/30] Loss: 0.3376/0.8137 Acc: 86.70%/75.48% 

‚úì Test Acc: 77.14%
‚úì F1 Macro: 0.5282
‚úì F1 Weighted: 0.7561
‚úì Time: 25.5 min

################################################################################
# 2/4: RESNET34
################################################################################

================================================================================
TRAINING RESNET34
================================================================================
[ 1/30] Loss: 0.7345/0.6753 Acc: 71.18%/74.34% ‚úì
[ 2/30] Loss: 0.6795/0.6699 Acc: 73.65%/74.69% ‚úì
[ 3/30] Loss: 0.6629/0.6684 Acc: 73.98%/75.17% ‚úì
[ 4/30] Loss: 0.6528/0.6331 Acc: 74.47%/75.41% ‚úì
[ 5/30] Loss: 0.6361/0.7345 Acc: 74.99%/73.69% 
[ 6/30] Loss: 0.6238/0.6079 Acc: 75.41%/76.16% ‚úì
[ 7/30] Loss: 0.6176/0.6246 Acc: 75.64%/76.02% 
[ 8/30] Loss: 0.6058/0.6049 Acc: 76.06%/76.53% ‚úì
[ 9/30] Loss: 0.6023/0.7067 Acc: 76.31%/75.12% 
[10/30] Loss: 0.5957/0.6323 Acc: 76.42%/75.65% 
[11/30] Loss: 0.5866/0.6156 Acc: 76.88%/76.78% ‚úì
[12/30] Loss: 0.5727/0.6560 Acc: 77.37%/75.26% 
[13/30] Loss: 0.5694/0.6800 Acc: 77.53%/74.39% 
[14/30] Loss: 0.5511/0.6046 Acc: 78.21%/76.72% 
[15/30] Loss: 0.5397/0.6239 Acc: 78.54%/76.66% 
[16/30] Loss: 0.5109/0.6723 Acc: 79.75%/75.15% 
[17/30] Loss: 0.4943/0.6607 Acc: 80.36%/75.28% 
[18/30] Loss: 0.4644/0.6767 Acc: 81.53%/75.47% 
[19/30] Loss: 0.4443/0.6776 Acc: 82.37%/75.78% 
[20/30] Loss: 0.4179/0.7214 Acc: 83.47%/76.10% 
[21/30] Loss: 0.3993/0.8876 Acc: 84.19%/73.74% 
[22/30] Loss: 0.3886/0.7555 Acc: 84.56%/75.85% 
[23/30] Loss: 0.3769/0.8936 Acc: 85.11%/73.47% 
[24/30] Loss: 0.3686/1.0483 Acc: 85.42%/71.60% 
[25/30] Loss: 0.3597/0.8384 Acc: 85.82%/75.45% 
[26/30] Loss: 0.3565/1.1578 Acc: 85.91%/73.04% 
[27/30] Loss: 0.3493/0.9903 Acc: 86.20%/73.70% 
