
================================================================================
TRAINING MULTIPLE MODEL ARCHITECTURES
================================================================================
Start Time: 2026-01-04 23:25:21
================================================================================

ğŸ–¥ï¸  Device: cuda
ğŸ“Š Training samples: 100000
ğŸ”¢ Models to train: 5
   - ResNet-50: 25.6M params, RESNET family
   - EfficientNet-B3: 12.0M params, EFFICIENTNET family
   - ConvNeXt-Tiny: 28.6M params, CONVNEXT family
   - DenseNet-121: 8.0M params, DENSENET family
   - Inception-V3: 23.8M params, INCEPTION family

--------------------------------------------------------------------------------
STEP 1: LOADING DATA (once, reused for all variants)
--------------------------------------------------------------------------------

1/4 Loading KLHK ground truth...
âœ“ Loaded 27,995 polygons

2/4 Loading Sentinel-2 imagery...
âœ“ Loaded mosaic: (10, 11268, 18740)

3/4 Calculating spectral indices...
âœ“ Total features: 23 bands

ğŸ§¹ Cleaning NaN/Inf values...
   Found NaN: True, Inf: False
   âœ“ Replaced with 0

4/4 Rasterizing KLHK labels...
âœ“ Rasterized labels: (11268, 18740)

ğŸ“¦ Preparing training dataset...

ğŸ“¦ Extracting patches:
   Patch size: 32x32
   Stride: 16
   Input shape: (23, 11268, 18740)
   Total possible patches: 822,510
   Valid patches: 480,718
   Sampling 100,000 patches...

   âš ï¸  Remapping non-sequential labels for PyTorch:
     0 â†’ 0
     1 â†’ 1
     4 â†’ 2
     5 â†’ 3
     6 â†’ 4
     7 â†’ 5

   Final patches: 100,000
   Patch shape: (23, 32, 32)

   Class distribution (after remapping):
     Class 0: 1,113 (1.1%)
     Class 1: 37,082 (37.1%)
     Class 2: 57,349 (57.3%)
     Class 3: 175 (0.2%)
     Class 4: 2,782 (2.8%)
     Class 5: 1,499 (1.5%)
âœ“ Extracted patches: X=(100000, 23, 32, 32), y=(100000,)

ğŸ“Š Normalizing each channel independently...
   Channel  0: mean=  0.0229, std=  0.0220
   Channel  5: mean=  0.1912, std=  0.1572
   Channel 10: mean=  0.4788, std=  0.3941
   Channel 15: mean= -0.1568, std=  0.1649
   Channel 20: mean=  0.4261, std=  0.3461
   Channel 22: mean=  0.3413, std=  0.2963
âœ“ Normalized to X_normalized shape: (100000, 23, 32, 32)

âœ“ Train set: 80,000 samples
âœ“ Test set: 20,000 samples


################################################################################
# MODEL 1/5: RESNET50
################################################################################

================================================================================
TRAINING ResNet-50 (RESNET)
================================================================================

ğŸ“ Output:
   Model: models/resnet50_best.pth
   Results: results/models/resnet50/

ğŸ“¦ Creating datasets...
âœ“ Train batches: 5000
âœ“ Test batches: 1250

ğŸ—ï¸  Creating ResNet-50...
   Family: resnet
   Pretrained: Yes (ImageNet)
   Input: 23 channels â†’ 6 classes
   âœ“ Total parameters: 23,583,046 (23.58M)
   âœ“ Trainable: 23,583,046 (23.58M)
   âœ“ Device: cuda

ğŸš€ Training for 30 epochs...
Epoch [ 1/30] Train Loss: 0.7275 Acc: 72.06% | Val Loss: 0.7444 Acc: 75.72% | Time: 85.6s âœ“ BEST
Epoch [ 2/30] Train Loss: 0.6598 Acc: 74.80% | Val Loss: 0.6461 Acc: 76.34% | Time: 99.0s âœ“ BEST
Epoch [ 3/30] Train Loss: 0.6337 Acc: 75.68% | Val Loss: 0.8737 Acc: 75.67% | Time: 107.3s 
Epoch [ 4/30] Train Loss: 0.6281 Acc: 76.02% | Val Loss: 0.6164 Acc: 76.70% | Time: 107.2s âœ“ BEST
Epoch [ 5/30] Train Loss: 0.6190 Acc: 76.32% | Val Loss: 0.6142 Acc: 76.77% | Time: 91.2s âœ“ BEST
Traceback (most recent call last):
  File "C:\Users\MyPC PRO\Documents\LandCover_Research\scripts\train_models.py", line 465, in <module>
    summary = train_model(
              ^^^^^^^^^^^^
  File "C:\Users\MyPC PRO\Documents\LandCover_Research\scripts\train_models.py", line 378, in train_model
    np.savez(
  File "C:\ProgramData\anaconda3\envs\landcover_jambi\Lib\site-packages\numpy\lib\npyio.py", line 639, in savez
    _savez(file, args, kwds, False)
  File "C:\ProgramData\anaconda3\envs\landcover_jambi\Lib\site-packages\numpy\lib\npyio.py", line 736, in _savez
    zipf = zipfile_factory(file, mode="w", compression=compression)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\envs\landcover_jambi\Lib\site-packages\numpy\lib\npyio.py", line 103, in zipfile_factory
    return zipfile.ZipFile(file, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\envs\landcover_jambi\Lib\zipfile.py", line 1311, in __init__
    self.fp = io.open(file, filemode)
              ^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'results/models/resnet50/training_history.npz'
