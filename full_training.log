
================================================================================
TRAINING MULTIPLE MODEL ARCHITECTURES
================================================================================
Start Time: 2026-01-04 23:35:44
================================================================================

üñ•Ô∏è  Device: cuda
üìä Training samples: 100000
üî¢ Models to train: 5
   - ResNet-50: 25.6M params, RESNET family
   - EfficientNet-B3: 12.0M params, EFFICIENTNET family
   - ConvNeXt-Tiny: 28.6M params, CONVNEXT family
   - DenseNet-121: 8.0M params, DENSENET family
   - Inception-V3: 23.8M params, INCEPTION family

--------------------------------------------------------------------------------
STEP 1: LOADING DATA (once, reused for all variants)
--------------------------------------------------------------------------------

1/4 Loading KLHK ground truth...
‚úì Loaded 27,995 polygons

2/4 Loading Sentinel-2 imagery...
‚úì Loaded mosaic: (10, 11268, 18740)

3/4 Calculating spectral indices...
‚úì Total features: 23 bands

üßπ Cleaning NaN/Inf values...
   Found NaN: True, Inf: False
   ‚úì Replaced with 0

4/4 Rasterizing KLHK labels...
‚úì Rasterized labels: (11268, 18740)

üì¶ Preparing training dataset...

üì¶ Extracting patches:
   Patch size: 32x32
   Stride: 16
   Input shape: (23, 11268, 18740)
   Total possible patches: 822,510
   Valid patches: 480,718
   Sampling 100,000 patches...

   ‚ö†Ô∏è  Remapping non-sequential labels for PyTorch:
     0 ‚Üí 0
     1 ‚Üí 1
     4 ‚Üí 2
     5 ‚Üí 3
     6 ‚Üí 4
     7 ‚Üí 5

   Final patches: 100,000
   Patch shape: (23, 32, 32)

   Class distribution (after remapping):
     Class 0: 1,113 (1.1%)
     Class 1: 37,082 (37.1%)
     Class 2: 57,349 (57.3%)
     Class 3: 175 (0.2%)
     Class 4: 2,782 (2.8%)
     Class 5: 1,499 (1.5%)
‚úì Extracted patches: X=(100000, 23, 32, 32), y=(100000,)

üìä Normalizing each channel independently...
   Channel  0: mean=  0.0229, std=  0.0220
   Channel  5: mean=  0.1912, std=  0.1572
   Channel 10: mean=  0.4788, std=  0.3941
   Channel 15: mean= -0.1568, std=  0.1649
   Channel 20: mean=  0.4261, std=  0.3461
   Channel 22: mean=  0.3413, std=  0.2963
‚úì Normalized to X_normalized shape: (100000, 23, 32, 32)

‚úì Train set: 80,000 samples
‚úì Test set: 20,000 samples


################################################################################
# MODEL 1/5: RESNET50
################################################################################

================================================================================
TRAINING ResNet-50 (RESNET)
================================================================================

üìÅ Output:
   Model: models/resnet50_best.pth
   Results: results/models/resnet50/

üì¶ Creating datasets...
‚úì Train batches: 5000
‚úì Test batches: 1250

üèóÔ∏è  Creating ResNet-50...
   Family: resnet
   Pretrained: Yes (ImageNet)
   Input: 23 channels ‚Üí 6 classes
   ‚úì Total parameters: 23,583,046 (23.58M)
   ‚úì Trainable: 23,583,046 (23.58M)
   ‚úì Device: cuda

üöÄ Training for 30 epochs...
Epoch [ 1/30] Train Loss: 0.7370 Acc: 71.73% | Val Loss: 0.6734 Acc: 75.39% | Time: 102.5s ‚úì BEST
Epoch [ 2/30] Train Loss: 0.6633 Acc: 74.74% | Val Loss: 0.6585 Acc: 75.98% | Time: 89.3s ‚úì BEST
Epoch [ 3/30] Train Loss: 0.6424 Acc: 75.70% | Val Loss: 0.6144 Acc: 76.80% | Time: 87.2s ‚úì BEST
Epoch [ 4/30] Train Loss: 0.6256 Acc: 75.99% | Val Loss: 0.7143 Acc: 76.59% | Time: 90.3s 
Epoch [ 5/30] Train Loss: 0.6134 Acc: 76.43% | Val Loss: 0.6099 Acc: 76.71% | Time: 86.8s 
Epoch [ 6/30] Train Loss: 0.6018 Acc: 76.73% | Val Loss: 0.6842 Acc: 76.48% | Time: 87.0s 
Epoch [ 7/30] Train Loss: 0.5982 Acc: 76.95% | Val Loss: 0.5886 Acc: 77.25% | Time: 87.9s ‚úì BEST
Epoch [ 8/30] Train Loss: 0.5903 Acc: 77.17% | Val Loss: 0.5814 Acc: 77.42% | Time: 89.3s ‚úì BEST
Epoch [ 9/30] Train Loss: 0.5915 Acc: 77.29% | Val Loss: 0.8675 Acc: 76.49% | Time: 87.2s 
Epoch [10/30] Train Loss: 0.5866 Acc: 77.50% | Val Loss: 0.8339 Acc: 76.30% | Time: 86.0s 
Epoch [11/30] Train Loss: 0.5802 Acc: 77.64% | Val Loss: 0.5805 Acc: 77.45% | Time: 87.0s ‚úì BEST
Epoch [12/30] Train Loss: 0.5723 Acc: 77.91% | Val Loss: 0.5897 Acc: 77.34% | Time: 88.9s 
Epoch [13/30] Train Loss: 0.5685 Acc: 78.03% | Val Loss: 0.5572 Acc: 78.24% | Time: 87.6s ‚úì BEST
Epoch [14/30] Train Loss: 0.5659 Acc: 78.17% | Val Loss: 0.6736 Acc: 75.00% | Time: 87.8s 
Epoch [15/30] Train Loss: 0.5612 Acc: 78.25% | Val Loss: 0.5999 Acc: 77.11% | Time: 86.3s 
Epoch [16/30] Train Loss: 0.5570 Acc: 78.45% | Val Loss: 0.5596 Acc: 78.25% | Time: 87.4s ‚úì BEST
Epoch [17/30] Train Loss: 0.5583 Acc: 78.53% | Val Loss: 0.5634 Acc: 78.35% | Time: 90.2s ‚úì BEST
Epoch [18/30] Train Loss: 0.5525 Acc: 78.62% | Val Loss: 0.5726 Acc: 77.82% | Time: 85.2s 
Epoch [19/30] Train Loss: 0.5500 Acc: 78.70% | Val Loss: 0.5868 Acc: 78.46% | Time: 88.8s ‚úì BEST
Epoch [20/30] Train Loss: 0.5521 Acc: 78.82% | Val Loss: 0.5588 Acc: 78.67% | Time: 86.8s ‚úì BEST
Epoch [21/30] Train Loss: 0.5433 Acc: 78.92% | Val Loss: 0.5831 Acc: 78.31% | Time: 89.0s 
Epoch [22/30] Train Loss: 0.5413 Acc: 79.08% | Val Loss: 0.5648 Acc: 78.35% | Time: 85.9s 
Epoch [23/30] Train Loss: 0.5400 Acc: 79.22% | Val Loss: 0.5686 Acc: 78.26% | Time: 89.6s 
Epoch [24/30] Train Loss: 0.5357 Acc: 79.21% | Val Loss: 0.5871 Acc: 78.50% | Time: 89.5s 
Epoch [25/30] Train Loss: 0.5328 Acc: 79.40% | Val Loss: 0.5705 Acc: 78.52% | Time: 88.2s 
Epoch [26/30] Train Loss: 0.5291 Acc: 79.59% | Val Loss: 0.9378 Acc: 76.17% | Time: 87.7s 
Epoch [27/30] Train Loss: 0.5295 Acc: 79.61% | Val Loss: 0.5746 Acc: 78.37% | Time: 87.7s 
Epoch [28/30] Train Loss: 0.5259 Acc: 79.77% | Val Loss: 0.5978 Acc: 77.77% | Time: 87.3s 
Epoch [29/30] Train Loss: 0.5231 Acc: 79.85% | Val Loss: 0.5533 Acc: 79.09% | Time: 88.9s ‚úì BEST
Epoch [30/30] Train Loss: 0.5205 Acc: 79.86% | Val Loss: 0.5674 Acc: 78.45% | Time: 87.9s 

üìä Final evaluation (best model from epoch 29)...

‚úÖ Test Accuracy: 79.09%
‚úÖ F1-Score (Macro): 0.5725
‚úÖ F1-Score (Weighted): 0.7778

‚è±Ô∏è  Training Time: 44.3 minutes
üìä Best Epoch: 29
üìä Best Val Acc: 79.09%

‚úÖ RESNET50 COMPLETE!
   Accuracy: 79.09%
   Time: 44.3 minutes


################################################################################
# MODEL 2/5: EFFICIENTNET_B3
################################################################################

================================================================================
TRAINING EfficientNet-B3 (EFFICIENTNET)
================================================================================

üìÅ Output:
   Model: models/efficientnet_b3_best.pth
   Results: results/models/efficientnet_b3/

üì¶ Creating datasets...
‚úì Train batches: 5000
‚úì Test batches: 1250

üèóÔ∏è  Creating EfficientNet-B3...
   Family: efficientnet
   Pretrained: Yes (ImageNet)
   Input: 23 channels ‚Üí 6 classes
   ‚úì Total parameters: 10,712,654 (10.71M)
   ‚úì Trainable: 10,712,654 (10.71M)
   ‚úì Device: cuda

üöÄ Training for 30 epochs...
Epoch [ 1/30] Train Loss: 1.1533 Acc: 61.33% | Val Loss: 0.7767 Acc: 71.45% | Time: 173.6s ‚úì BEST
Epoch [ 2/30] Train Loss: 0.7428 Acc: 71.54% | Val Loss: 0.6789 Acc: 74.72% | Time: 180.3s ‚úì BEST
Epoch [ 3/30] Train Loss: 0.6949 Acc: 73.55% | Val Loss: 0.7164 Acc: 74.63% | Time: 168.5s 
Epoch [ 4/30] Train Loss: 0.6620 Acc: 74.83% | Val Loss: 0.6667 Acc: 75.55% | Time: 174.1s ‚úì BEST
Epoch [ 5/30] Train Loss: 0.6436 Acc: 75.61% | Val Loss: 1.0939 Acc: 64.01% | Time: 180.4s 
Epoch [ 6/30] Train Loss: 0.6319 Acc: 75.87% | Val Loss: 0.6317 Acc: 77.07% | Time: 178.7s ‚úì BEST
Epoch [ 7/30] Train Loss: 0.6199 Acc: 76.34% | Val Loss: 0.5962 Acc: 77.09% | Time: 179.0s ‚úì BEST
Epoch [ 8/30] Train Loss: 0.6106 Acc: 76.70% | Val Loss: 0.6207 Acc: 77.35% | Time: 180.2s ‚úì BEST
Epoch [ 9/30] Train Loss: 0.6041 Acc: 76.94% | Val Loss: 0.6015 Acc: 77.33% | Time: 182.3s 
Epoch [10/30] Train Loss: 0.6031 Acc: 76.89% | Val Loss: 0.7482 Acc: 77.08% | Time: 178.2s 
Epoch [11/30] Train Loss: 0.5983 Acc: 77.17% | Val Loss: 0.7033 Acc: 76.47% | Time: 180.5s 
Epoch [12/30] Train Loss: 0.5910 Acc: 77.31% | Val Loss: 0.6043 Acc: 77.91% | Time: 179.7s ‚úì BEST
Epoch [13/30] Train Loss: 0.5865 Acc: 77.50% | Val Loss: 0.5909 Acc: 77.30% | Time: 181.2s 
Epoch [14/30] Train Loss: 0.5836 Acc: 77.68% | Val Loss: 0.7521 Acc: 76.09% | Time: 179.6s 
Epoch [15/30] Train Loss: 0.5801 Acc: 77.87% | Val Loss: 0.6323 Acc: 76.93% | Time: 178.3s 
Epoch [16/30] Train Loss: 0.5748 Acc: 77.96% | Val Loss: 0.6100 Acc: 77.01% | Time: 181.5s 
